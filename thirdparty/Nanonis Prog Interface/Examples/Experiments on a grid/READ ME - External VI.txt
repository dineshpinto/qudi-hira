Nanonis documentation for using external VIs "Experiments on a Grid"
----------------------------------------------------------------------


In order to use the "external VI" functionality in "Experiments on a Grid", the following criteria must be met:

1) VI Server in LabVIEW
The external VI is running in LabVIEW. To allow access to LabVIEW, VI Server must be enabled and TCP/IP access must be granted for some IP addresses. To do this, follow these steps:
  a) in LabVIEW, go to Tools > Options
  b) select "VI Server: Configuration"
  c) activate the TCP/IP protocol (checkmark set) and set Port to 3363
  d) select "VI Server: TCP/IP Access" (in LV8: "VI Server: Machine Access")
  e) make sure 127.0.0.1 (local machine) is listed in the TCP/IP Access list
  f) add the IP adress(es) of the local machine to the list
Note to f): to find out the IP address(es) of the local machine, type "ipconfig" on the command line (Start > Run... > cmd : ipconfig). If you have more than one network adapter, the ipconfig command will show multiple IP addresses. Add them all to the TCP/IP Access list.
Note: You might need to restart LabVIEW after enabling VI Server.
At this time, your firewall might pop up and tell you that LabVIEW asks for Server rights (it listens on the port 3363 specified above). You have to allow this in order to use the functionality.

2) External VI connector pattern
The connector pattern of the external VI must exactly match the description in the online help page of the "Experiments on a Grid" (type F1 to open that help page). To develop your own external VIs, it might be the easiest way to start with on of the Grid Measurements Example VIs (available in the programming interface) and modify it.

3) LabVIEW
LabVIEW must be running if you want to call the external VI, but the VI doesn't have to be open if the full path is specified in "Experiments on a Grid".